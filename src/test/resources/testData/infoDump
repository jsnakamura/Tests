package helpers;

import java.io.FileInputStream;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;

import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

public class DataHelper {

	public static HashMap<String, String> storeValues = new HashMap<String, String>();

	public static List<HashMap<String, String>> data() {

		List<HashMap<String, String>> myData = new ArrayList<>();

		try {
			FileInputStream fileInput = new FileInputStream(
					System.getProperty("user.dir") + "//src//test//resources//testData/TestData.xlsx");

			@SuppressWarnings("resource")
			XSSFWorkbook workbook = new XSSFWorkbook(fileInput);
			XSSFSheet sheet = workbook.getSheet("TestData");

			Row headerRow = sheet.getRow(0);

			sheet.forEach((Row row) -> {
			
				if (row.getRowNum() == 0)
					return;
				
				HashMap<String, String> currentHash = new HashMap<String, String>();

				row.forEach((Cell cell) -> {
					currentHash.put(headerRow.getCell(cell.getColumnIndex()).getStringCellValue(),
							cell.getStringCellValue());
				});

				myData.add(currentHash);
			});

			fileInput.close();

		} catch (Exception e) {
			e.printStackTrace();
		}

		return myData;
	}
}


//*[@id='center_column']/div/form/div[1]/div[1]/div[1]/label/div/span/input
